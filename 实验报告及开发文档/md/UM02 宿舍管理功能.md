
在宿舍管理功能模块中，主要包含了宿舍楼的增、删、查、改等操作。该模块的目的是为了使管理员能够方便地管理宿舍楼及其下属房间的信息。具体实现的功能包括宿舍楼的添加、删除、查看以及信息的修改。

### 1. 添加宿舍楼

添加宿舍楼的功能首先要求管理员输入宿舍楼的名称、性别和位置等基础信息。在输入过程中，通过不断检查输入的有效性，确保宿舍楼名称的唯一性和性别的合法性。对于每个新增的宿舍楼，还需要自动生成并插入若干房间，房间的数量和床位数由管理员指定。

**步骤：**

1. 输入宿舍楼名称，并检查该名称是否已存在。如果宿舍楼名称已存在，则要求管理员重新输入。
2. 输入宿舍楼性别，且必须选择“男”或“女”，否则要求重新输入。
3. 输入宿舍楼位置，提供位置描述。
4. 通过SQL插入语句将宿舍楼的信息写入数据库。
5. 获取新插入宿舍楼的ID，并输入房间数量和每个房间的床位数。
6. 自动生成房间号，并将房间信息插入数据库。

**遇到的问题与解决：**

- 问题：如果输入的宿舍楼名称已经存在，系统无法继续进行后续操作。
- 解决：在输入宿舍楼名称时，增加对名称是否已存在的检查，若存在，则提示重新输入。

**收获：**

- 学会了如何在数据库中管理多表数据，尤其是如何通过宿舍楼ID来关联并自动生成房间数据。

### 2. 删除宿舍楼

删除宿舍楼时，首先会列出所有宿舍楼的信息供管理员选择。管理员输入目标宿舍楼名称后，系统会检查该宿舍楼是否存在。如果存在，则继续进行删除操作，否则提示管理员该宿舍楼不存在。在删除宿舍楼前，还需要检查该宿舍楼下是否有房间以及房间是否已入住。如果有学生入住，系统会阻止删除操作。

**步骤：**

1. 显示所有宿舍楼信息供管理员选择删除。
2. 输入待删除的宿舍楼名称，检查其是否存在。
3. 获取该宿舍楼下所有房间的ID，并检查每个房间的入住情况。
4. 如果房间已经被学生入住，则提示管理员处理学生的退宿事宜。
5. 如果该宿舍楼下无房间或所有房间为空房，则允许删除。
6. 确认删除操作，删除该宿舍楼及其相关房间。

**遇到的问题与解决：**

- 问题：删除宿舍楼时需要判断是否有学生入住，如果有学生入住，不能直接删除。
- 解决：遍历宿舍楼下所有房间，并查询每个房间是否有学生入住，只有在所有房间空置时才能进行删除操作。

**收获：**

- 掌握了如何处理带有外键关系的删除操作，并能够通过多表联动检查数据是否符合删除条件。
- 深入理解了如何设计删除操作时的逻辑，确保数据一致性和完整性。

### 3. 查看所有宿舍楼信息

查看所有宿舍楼信息的功能是为了让管理员了解各宿舍楼的基本情况，包括宿舍楼的名称、性别、位置、房间数量、总容量、已入住人数以及占用率等。这些信息通过SQL查询汇总并打印出来。

**步骤：**

1. 使用SQL查询语句获取所有宿舍楼的基本信息及其下属房间的数据。
2. 汇总信息并按宿舍楼分组，计算每个宿舍楼的房间数、总容量、已入住人数以及占用比率。
3. 打印查询结果，展示给管理员。

**遇到的问题与解决：**

- 问题：如何汇总每个宿舍楼的房间数量和入住情况。
- 解决：使用SQL的聚合函数，如COUNT、SUM等来统计每个宿舍楼的房间数量、总容量及已入住人数，并计算占用比率。

**收获：**

- 通过这个功能，加深了对SQL查询的理解，尤其是如何使用JOIN和GROUP BY来汇总和统计信息。

### 4. 修改宿舍信息

修改宿舍信息的功能允许管理员对已有宿舍楼的名称和位置进行修改。管理员可以选择要修改的宿舍楼，并根据需要修改其名称或位置。

**步骤：**

1. 显示所有宿舍楼的信息。
2. 输入要修改的宿舍楼名称，并检查该宿舍楼是否存在。
3. 提供修改内容的选择（宿舍楼名称或位置）。
4. 根据管理员的选择，更新数据库中的宿舍楼信息。

**遇到的问题与解决：**

- 问题：如何确保管理员修改的内容是有效的，并且操作简便。
- 解决：提供清晰的操作选项，并通过循环和条件判断确保管理员输入的内容符合预期。

**收获：**

- 深刻理解了如何通过SQL语句进行条件更新，以及如何设计用户交互流程以确保操作的顺利进行。

### 总结

宿舍管理功能模块的实现，使得管理员可以方便地管理宿舍楼及其房间的信息。通过这一模块的开发，我掌握了数据库操作的多种方式，包括数据的插入、删除、查询和更新。同时，解决了在管理过程中可能遇到的多个问题，例如数据一致性、外键关系的处理等。