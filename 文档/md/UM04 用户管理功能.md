

在宿舍管理系统中，用户管理功能主要包括添加用户、删除用户、查询用户信息等操作。这个功能旨在帮助宿舍管理员有效地管理系统中的用户，确保用户的账户信息、入住情况以及联系方式等数据的准确性和完整性。以下是实现过程的详细描述。

### 1. 添加用户

用户的添加功能是系统中最基本的操作之一，管理员通过此功能可以新增学生用户，并为其分配必要的账户信息。具体步骤如下：

- **输入用户数量**：管理员首先输入需要添加的用户数量。若输入 `0` 则返回上一级。
- **学号验证**：每添加一位用户，系统首先要求输入学号。如果该学号已经存在于系统中，系统会提示用户重新输入，直到学号唯一为止。
- **生成密码**：若学号长度小于等于6位，默认将学号作为密码；若学号长度大于6位，则使用学号后六位作为默认密码。
- **输入基本信息**：管理员需要输入用户的姓名、性别和联系方式。性别需为“男”或“女”，如输入无效则会继续提示。
- **用户注册**：系统通过调用注册用户的接口，将用户信息保存到数据库中。

这个功能确保了用户信息的完整性，并且通过学号唯一性和自动生成密码，减少了人为错误。

### 2. 删除用户

删除用户的功能主要用于移除系统中不再需要的用户。操作步骤如下：

- **检查入住情况**：删除前，系统会首先检查该用户是否已入住。如果该用户已入住，则会提示管理员先处理退宿事宜。
- **确认删除**：系统会显示该用户的基本信息并要求管理员确认是否删除。如果管理员选择“yes”，则继续删除操作；若选择“no”，则取消操作。
- **执行删除**：确认删除后，系统会执行数据库中的删除操作，将该用户从系统中移除。

在这个过程中，删除操作会被严格要求确认，以防止误删操作。系统还确保了删除的用户没有未处理的入住信息，避免删除过程中出现数据不一致的情况。

### 3. 查询用户信息

查询用户信息功能是用户管理模块的核心之一，管理员可以通过不同的方式查询系统中的用户信息：

- **通过学号查询**：管理员可以输入学号来查询单个用户的信息。如果用户未入住，则显示用户的基本信息；如果用户已入住，则同时显示其所在宿舍楼和房间号。
- **通过姓名查询**：此功能支持模糊查询，通过姓名的一部分即可查询到相关用户。如果查询结果为空，系统会提示用户未找到相关信息。
- **查询所有用户信息**：管理员可以选择查看系统中所有用户的信息。该功能将展示每个用户的学号、姓名、性别、联系方式以及是否已分配宿舍信息，便于管理员快速浏览所有用户的基本情况。

该功能模块的设计使得管理员可以灵活查询用户信息，满足不同的查询需求，并且能根据查询结果对用户进行后续的管理操作。

### 4. 遇到的问题与解决方案

在开发用户管理功能时，我们遇到了一些技术问题，主要包括以下几个方面：

- **学号重复问题**：用户注册时，学号的唯一性非常重要。在最初的设计中，未能充分检查学号是否重复，导致用户添加时容易出现冲突。为了解决这一问题，我们在添加用户时增加了学号的唯一性验证，确保每个学号只能注册一次。
- **删除用户时的退宿问题**：在删除已入住的用户时，我们发现如果没有先处理退宿问题，删除操作可能导致数据的不一致。为此，我们设计了退宿的预处理步骤，在删除用户前检查其入住状态，确保在删除前妥善处理其宿舍信息。
- **查询功能的性能问题**：随着系统中用户数量的增加，查询所有用户信息的功能可能会导致性能问题。为此，我们在查询时使用了适当的索引，并确保查询条件明确，避免全表扫描，以提高查询效率。

### 5. 收获与总结

在开发过程中，我们不仅解决了学号唯一性验证、删除用户时的退宿问题，还通过多次优化查询和删除操作的效率，使得系统在实际运行时更加流畅。通过实现这一模块，我们更加深入地理解了数据库管理中的一些关键概念，如事务处理、数据一致性及索引优化等。
